# 业务描述
简易版论坛系统<br>
主要分三大角色：管理员，博客主，游客
按角色区分功能
## 管理员
* 用户管理
* 用户登录日志
* 文章管理
* 专题管理
* 浏览记录
* 友情链接

## 博客主
* 个人信息管理
* 用户登录日志
* 关注用户
* 粉丝查看
* 关注管理
* 类目管理
* 文章管理
* 点赞文章
* 点赞文章管理
* 收藏文章
* 文章收藏管理
* 评价文章
* 评价管理(当前用户对其他文章的评价)
* 文章评价管理(其他用户对当前用户文章的评价)
* 专题管理

## 游客
* 首页
* 文章列表
* 专题页
* 文章详情

辅助功能有数据分析(PV/UV等),黑名单(IP限制),友情链接<br>
后续可继续迭代，网站访问分析，访问行为分析，推文等功能

# 功能点

## 用户
### 用户注册
用户填写基本信息进行注册<br>
目前提供 用户名注册、邮箱注册<br>
后期迭代：同一个ip十五分钟内重复注册，则需要填写校验码(TODO)
#### 用户名注册
填写用户名、密码进行注册<br>
填写信息

* 用户名
* 密码

校验

1. 用户名校验（用户名重复，特殊字符）
2. 密码强度校验（不能与昵称一致）

#### 邮箱注册(TODO)
用户填写邮箱获取密码设置链接，点开链接后，设置密码<br>
填写信息
* 邮箱
* 密码

### 用户登录
用户通过用户名(邮箱)密码登录，如果5分钟内失败5次以上，需要填写校验码<br>

填写信息

* 用户名（邮箱）
* 密码
* 校验码（非必填）

校验

1. 用户名校验
2. 密码校验

数据记录

* 记录每一次的登录ip以及时间

### 用户信息维护
用户维护基本信息，包括以下几项

* 昵称
* 邮箱
* 手机号
* 头像（默认通过 secure.gravatar.com 自动获取）
* 主页
* 性别
* 真实姓名
* 出生日期
* 故乡
* 简介
* 职业

### 密码修改
用户根据原密码修改密码

后期扩展：密码安全问题、邮箱验证码、手机验证码

### 忘记密码(TODO)
通过邮箱链接重置密码

### 管理员 - 用户管理
管理员冻结或解冻用户

### 管理员 - 登录日志
查询全平台用户登录情况

展示字段

* 用户
* ip
* 登录时间
* 注销时间

后期扩展：登录地(TODO)

### 博客主 - 登录日志
查看当前用户的登录情况

展示字段

* ip
* 登录时间
* 注销时间

后期扩展：登录地(TODO)

### 用户关注(TODO)
关注用户，用于后续砖石关注人的消息推送以及文章查看

### 关注人列表(TODO)
展示已经关注了的用户

### 粉丝列表(TODO)
展示当前关注自己的用户

## 分类
用户管理自己的分类，获取所有分类展示在侧边栏，允许新增、编辑、删除
### 分类展示
侧边栏展示

### 分类创建
创建文章的分类，便于后续文章筛选管理<br>

填写字段

* 分类名称

校验

1. 当前用户下是否存在相同名称类目

### 分类编辑
修改分类名称

### 分类删除
删除不用的分类，如果存在文章关联，禁止删除

## 文章
### 管理员 - 文章列表
用户后台管理文章<br>

展示字段

* id
* 作者
* 标题
* 浏览/点赞
* 收藏/评价(TODO)
* 状态：0.私有，1.公开，-1.撤下，-99.删除
* 创建时间
* 操作
	* 撤下、查看评价(TODO)
	* 恢复、查看评价(TODO)

搜索条件

* 标题
* 作者
* 创建时间（开始 ~ 结束）

### 博客主 - 文章列表
用户后台管理文章<br>

展示字段

* 标题（查出部分...）
* 浏览/点赞
* 收藏/评价
* 状态：0.私有，1.公开，-1.撤下，-99.删除
* 创建时间
* 操作
	* 状态为私有时：编辑，设为公开，删除、查看评价(TODO)
	* 状态为公开时：编辑，设为私有，删除、查看评价(TODO)
	* 状态为撤下时：查看评价
	

搜索条件

* 标题
* 创建时间（开始 ~ 结束）

### 博客主 - 新建文章
用户新建文章，用户可以选择富文本编辑器也可以选择markdown编辑器，默认富文本<br>

填写内容

* 标题
* 分类（下拉选择）
* 内容
* 文章权限（后端默认私有）

#### 富文本文章
使用富文本编辑器实现文章内容编辑

#### markdown
使用markdown形式实现文章内容编辑<br>

后端需要生成文章内容简介，根据规则从文本中截取部分文字

### 博客主 - 编辑文章
用户编辑文章，根据文章内容类型，选择对应的编辑器渲染<br>

填写内容

* 标题
* 内容

#### 富文本文章
使用富文本编辑器实现文章内容编辑

#### markdown
使用markdown形式实现文章内容编辑<br>

后端需要生成文章内容简介，根据规则从文本中截取部分文字

### 博客主 - 编辑文章权限
设置文章权限为公开或私有

### 博客主 - 删除文章
删除文章（逻辑删除）

### 管理员 - 撤下文章
撤下文章，仅在博客主文章列表中显示被撤下标识

### 管理员 - 恢复文章
恢复被撤下的文章
        
## 浏览量
前端固定请求后端数据采集接口，后端进行数据采集<br>

数据

* URL
* ip地址（如果路由后不能获取正确的ip地址等信息则需要传ip）

后端全局监听浏览量，监听api的请求记录（文章记录）<br>
前端控制页面数据采集（需要确认，通过前端路由后是否能够获取正确的ip地址）

## 点赞管理(TODO)

### 点赞(TODO)
文章点赞，记录文章、用户以及ip，必须登录后才能点赞

### 点赞查看(TODO)
查看自己点赞过的文章，根据点赞时间倒序排序，允许取消点赞

### 取消点赞(TODO)
取消对文章的点赞

## 收藏管理（TODO）

### 收藏(TODO)
收藏文章，绑定文章与收藏着的关系

### 收藏列表(TODO)
查看当前收藏的文章，根据收藏时间倒序排序，允许取消收藏

### 取消收藏(TODO)
取消对文章的收藏

## 评论管理(TODO)

### 评论(TODO)
对文章进行评论，仅支持文本、表情，不支持图片

### 博客主 - 文章评论管理(TODO)
查看对应文章的评论，并允许对评论进行回复以及隐藏评论

### 管理员 - 文章评论查看(TODO)
查看对应的文章评论，允许操作屏蔽

### 博客主 - 评论回复(TODO)
回复评论

### 博客主 - 评论管理(TODO)
查看自己对其他文章的评论（不包含自己的文章评论回复），允许删除评论（级联删除）和回复评论回复等

## 专题(TODO)

### 博客主 - 专题展示(TODO)
列表展示当前博客主拥有的专题，允许编辑

### 博客主 - 创建专题(TODO)
创建专题

填写内容

* 名称
* logo
* 描述
* 是否允许投稿
* 投稿是否审核
* 其他管理员

### 博客主 - 专题管理(TODO)
展示专题基本信息，允许编辑专题信息、审核文章、剔除文章、维护管理员等操作

展示字段

* 专题名
* 文章数
* 关注人数
* 创建时间

### 博客主 - 编辑专题(TODO)
编辑专题数据

填写内容

* 名称
* logo
* 描述
* 是否允许投稿
* 投稿是否审核

### 博客主 - 投稿(TODO)
博客主向其他博客主的专题投递文章

展示当前博客主文章列表，选择进行投递，一次只能投递一篇

### 博客主 - 审核文章(TODO)
审核投递的文章，操作未 通过/驳回

驳回时填写驳回原因

### 博客主 - 剔除文章(TODO)
将当前已经审核过的文章剔除到专题外，需要填写剔除原因

### 博客主 - 维护管理员(TODO)
维护专题其他管理员

### 博客主 - 关注专题(TODO)
关注专题，用于后续的专题文章推送

### 博客主 - 关注专题列表(TODO)
查看当前已经关注了的专题列表，允许取消关注

### 博客主 - 取消专注专题(TODO)
取消当前已经关注了的专题

### 博客主 - 设置推荐博客主(TODO)
选择在当前专题有文章的博客主，并设定为推荐博客主

### 管理员 - 专题列表(TODO)
展示全平台的专题数据

展示字段

* 专题名
* 专题主
* 文章数
* 关注人数
* 创建时间

## 说说(TODO)
    - 说说
        - 内容
        - 图片
        - 评论
        - 点赞
        - 时间戳

## 相册(TODO)
    - 相册
        - 标题，标签，图片数量，密码，是否可见
    - 照片
    

## 数据统计(TODO)
    - pv
    - uv
    - 有效用户率
    - 文章浏览量排行榜
    - 相册浏览量排行榜

## 配置
### 友情链接管理
#### 列表
友情链接分页

展示字段

* 网站名称
* 链接
* 是否展示
* 优先级
* 操作
	* 隐藏时：显示，删除
	* 显示时：隐藏，删除

全局操作<br>
优先级设置：页面展示所有友情链接，通过上下移动控制优先级，传给后端时，按照列表编号，从1开始，递增

#### 创建友情链接
添加友情链接，默认不展示

填写内容

* 网站名称
* 链接

#### 编辑友情链接
编辑友情链接

填写内容

* 网站名称
* 链接

#### 显示/隐藏
设置友情链接为显示或隐藏

#### 删除友情链接
物理删除友情链接

### 邮件(TODO)
    - 邮件
        - 配置
        - 发送，富文本
### 黑名单(TODO)
    - 黑名单
        - 恶意ip屏蔽
    

# 三、数据库设计

## 1、表设计

## 2、执行SQL

